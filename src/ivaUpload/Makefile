IVRUPLOAD_DIR1 = ./
IVRUPLOAD_DIR2 = Protocol/
IVRUPLOAD_DIR3 = Preview/
IVRUPLOAD_DIR4 = Notify/

IVRUPLOAD_INCLUDE_DIR1 = $(IVRUPLOAD_DIR1)
IVRUPLOAD_INCLUDE_DIR2 = $(IVRUPLOAD_DIR2)
IVRUPLOAD_INCLUDE_DIR3 = $(IVRUPLOAD_DIR3)
IVRUPLOAD_INCLUDE_DIR4 = $(IVRUPLOAD_DIR4)


INSTALL_DIR = $(BIN_DIR) 

LDFLAGS = $(MQ_LIB)
LDFLAGS += $(OAL_LIB)
LDFLAGS += $(GLOBAL_LIB)
LDFLAGS += $(TINYFTP_LIB)
LDFLAGS += -lxml2
LDFLAGS += -lcurl
LDFLAGS += -liconv
LDFLAGS += -ljsoncpp
LDFLAGS += -lmosquitto
LDFLAGS += -lrt -lpthread -ldl

LDFLAGS += -L$(LIB_DIR)

CFLAGS += -I$(GLOBAL_INCLUDE_DIR) -I$(OAL_INCLUDE_DIR)
CFLAGS += -I$(MQ_INCLUDE_DIR)
CFLAGS += -I$(FTP_INCLUDE_DIR)
CFLAGS += -I$(3RDLIB_INCLUDE_DIR)
CFLAGS += -I$(3RDLIB_INCLUDE_DIR)libxml2
CFLAGS += -I$(IVRUPLOAD_INCLUDE_DIR2)
CFLAGS += -I$(IVRUPLOAD_INCLUDE_DIR3)
CFLAGS += -I$(IVRUPLOAD_INCLUDE_DIR4)


CONFIG_FILE = ivaUpload.ini

TARGET = ivaUpload

RELTARGET = $(TARGET)

SOURCES1 = $(wildcard $(IVRUPLOAD_DIR1)*.cpp)
SOURCES2 = $(wildcard $(IVRUPLOAD_DIR2)*.cpp)
SOURCES3 = $(wildcard $(IVRUPLOAD_DIR3)*.cpp)
SOURCES4 = $(wildcard $(IVRUPLOAD_DIR4)*.cpp)

RELOBJFILES1 = $(SOURCES1:%.cpp=%.o)
RELOBJFILES2 = $(SOURCES2:%.cpp=%.o)
RELOBJFILES3 = $(SOURCES3:%.cpp=%.o)
RELOBJFILES4 = $(SOURCES4:%.cpp=%.o)

.PHONY: clean install

all: $(RELTARGET)

	
$(RELTARGET): $(RELOBJFILES1) $(RELOBJFILES2) $(RELOBJFILES3)  $(RELOBJFILES4)
	$(CC) -o $@ $^ $(LDFLAGS)

$(RELOBJFILES1): %.o: %.cpp
	$(CPLUSPLUS) -c $(CFLAGS) $< -o $@ 
	
$(RELOBJFILES2): %.o: %.cpp
	$(CPLUSPLUS) -c $(CFLAGS) $< -o $@ 
	
$(RELOBJFILES3): %.o: %.cpp
	$(CPLUSPLUS) -c $(CFLAGS) $< -o $@
	
$(RELOBJFILES4): %.o: %.cpp
	$(CPLUSPLUS) -c $(CFLAGS) $< -o $@

install: 
	install -d $(INSTALL_DIR)
	install $(RELTARGET) $(INSTALL_DIR)
	install $(CONFIG_FILE) $(INSTALL_DIR)
	
clean:
	rm -f $(RELOBJFILES1) $(RELOBJFILES2) $(RELOBJFILES3) $(RELOBJFILES4) $(RELTARGET)
